state == 40 ~ "Oklahoma",
state == 41 ~ "Oregon",
state == 42 ~ "Pennsylvania",
state == 44 ~ "Rhode Island",
state == 45 ~ "South Carolina",
state == 46 ~ "South Dakota",
state == 47 ~ "Tennessee",
state == 48 ~ "Texas",
state == 49 ~ "Utah",
state == 50 ~ "Vermont",
state == 51 ~ "Virginia",
state == 53 ~ "Washington",
state == 54 ~ "West Virginia",
state == 55 ~ "Wisconsin",
state == 56 ~ "Wyoming"
)
)
ggplot(a3data2, aes(x = year, y = mrate, group = statename)) +
geom_line(aes(color = statename), alpha = .2) +
theme_pander(nomargin=FALSE, boxes=TRUE)
data <- a3data2 %>% mutate(treat = ifelse(state == 1,1,0),
yearfac = factor(year, levels = unique(year)))
lm5 <- feols(Rate ~ i(mrate, treat, "1974") | state + year, data = data)
lm5 <- feols(mrate ~ i(yearfac, treat, "1974") | state + year, data = data)
iplot(lm5, pt.join = TRUE)
lm5 <- feols(mrate ~ i(year, treat, "1974") | state + year, data = data)
iplot(lm5, pt.join = TRUE)
data <- a3data2 %>% mutate(treat = ifelse(state == 1,1,0),
yearfac = factor(year, levels = unique(year))) %>%
filter(state == 1 | state == 5)
lm5 <- feols(mrate ~ i(year, treat, "1974") | state + year, data = data)
iplot(lm5, pt.join = TRUE)
feols(mrate ~ i(year, treat, "1974") | state + year, data = data)
View(data)
feols(mrate ~ i(year, treat, "1974") |  year, data = data)
feols(mrate ~ i(year, treat, "1974") + treat |  year, data = data)
lm5 <- feols(mrate ~ i(year, treat, "1974") , data = data)
lm5
summary(lm5)
lm5 <- feols(mrate ~ i(year, treat, "1974") + treat , data = data)
summary(lm5)
lm5 <- feols(mrate ~ i(year, treat, "1974") + treat | year , data = data)
lm5
summary(lm5)
lm5 <- feols(mrate ~ i(year, treat, "1974") + treat + factor(year) , data = data)
lm5
summary(lm5)
URL <- "https://raw.githubusercontent.com/DS4PS/pe4ps-textbook/master/data/RegDisc2.csv"
data <- read.csv( URL, stringsAsFactors=F ) %>%
select(agecell, all, alcohol, mva)
View(data)
URL <- "https://raw.githubusercontent.com/DS4PS/pe4ps-textbook/master/data/RegDisc2.csv"
data <- read.csv( URL, stringsAsFactors=F ) %>%
select(agecell, all, alcohol, mva)
save(data, file = "assignments/files/a3data1.RData")
URL <- "https://raw.githubusercontent.com/DS4PS/pe4ps-textbook/master/data/RegDisc2.csv"
data <- read.csv( URL, stringsAsFactors=F ) %>%
select(agecell, all, alcohol, mva)
write_csv(data, "assignments/files/a3data1.csv")
a3data2 <- read_dta("assignments/files/a3data2.dta") %>%
select(year, state, mrate) %>%
mutate(statename = case_when(
state == 1 ~ "Alabama",
state == 2 ~ "Alaska",
state == 4 ~ "Arizona",
state == 5 ~ "Arkansas",
state == 6 ~ "California",
state == 8 ~ "Colorado",
state == 9 ~ "Connecticut",
state == 10 ~ "Delaware",
state == 11 ~ "District of Columbia",
state == 12 ~ "Florida",
state == 13 ~ "Georgia",
state == 15 ~ "Hawaii",
state == 16 ~ "Idaho",
state == 17 ~ "Illinois",
state == 18 ~ "Indiana",
state == 19 ~ "Iowa",
state == 20 ~ "Kansas",
state == 21 ~ "Kentucky",
state == 22 ~ "Louisiana",
state == 23 ~ "Maine",
state == 24 ~ "Maryland",
state == 25 ~ "Massachusetts",
state == 26 ~ "Michigan",
state == 27 ~ "Minnesota",
state == 28 ~ "Mississippi",
state == 29 ~ "Missouri",
state == 30 ~ "Montana",
state == 31 ~ "Nebraska",
state == 32 ~ "Nevada",
state == 33 ~ "New Hampshire",
state == 34 ~ "New Jersey",
state == 35 ~ "New Mexico",
state == 36 ~ "New York",
state == 37 ~ "North Carolina",
state == 38 ~ "North Dakota",
state == 39 ~ "Ohio",
state == 40 ~ "Oklahoma",
state == 41 ~ "Oregon",
state == 42 ~ "Pennsylvania",
state == 44 ~ "Rhode Island",
state == 45 ~ "South Carolina",
state == 46 ~ "South Dakota",
state == 47 ~ "Tennessee",
state == 48 ~ "Texas",
state == 49 ~ "Utah",
state == 50 ~ "Vermont",
state == 51 ~ "Virginia",
state == 53 ~ "Washington",
state == 54 ~ "West Virginia",
state == 55 ~ "Wisconsin",
state == 56 ~ "Wyoming")
)
write_csv(a3data2,"assignments/files/a3data2.csv")
set.seed(1234)
data <- list(
data1 <- tibble(
t = rep(1:T),
i = 1,
a = 1,
x = rnorm(10, 0, 1),
y = 9 - x + a + rnorm(T, 0, 1)
),
data2 <- tibble(
t = rep(1:T),
i = 2,
a = 12,
x = rnorm(10, 3, 1),
y = 9 - x + a + rnorm(T, 0, 1)
),
data3 <- tibble(
t = rep(1:T),
i = 3,
a = 22,
x = rnorm(10, 5, 1),
y = 9 - x + a + rnorm(T, 0, 1)
)) %>%
list.rbind()
ggplot(data, aes(y = y, x = x, color = as.factor(i))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black", alpha = .5, size = 1.5) +
theme_pander(nomargin = FALSE) +
labs(title = "Fixed Effects Estimator") +
guides(color=guide_legend(title="Individual"))
ggplot(data, aes(y = y, x = x, color = as.factor(i))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_pander(nomargin = FALSE) +
labs(title = "Fixed Effects Estimator") +
guides(color=guide_legend(title="Individual"))
ggplot(data, aes(y = y, x = x, color = as.factor(i))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, alpha = .5, size = 1.5) +
theme_pander(nomargin = FALSE) +
labs(title = "Fixed Effects Estimator") +
guides(color=guide_legend(title="Individual"))
ggplot(data, aes(y = y, x = x, color = as.factor(i))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, alpha = .2, size = 1.5) +
theme_pander(nomargin = FALSE) +
labs(title = "Fixed Effects Estimator") +
guides(color=guide_legend(title="Individual"))
library(plm)
library(tidyverse)
library(vtable)
library(plm)
library(magrittr)
library(stargazer)
library(modelsummary)
# set seed
set.seed(12345)
#First create data so that w is assigned randomly
create_panel_data <- function(N,T) {
panel_data <- crossing(ID = 1:N, t = 1:T) %>%
mutate(eta = rnorm(n(), mean=0, sd=10))
indiv_data <- data.frame(ID = 1:N,
a = rnorm(N,0,10))
panel_data %<>%
full_join(indiv_data, by = 'ID') %>%
mutate(y0 = 2 + a + eta,
y1 = y0 + 4,
w = ifelse(runif(n()) > 0.5 & t >= 3, 1, 0),
y = y0 + (y1 - y0)*w)
return(panel_data)
}
# get summary statistics
data <- create_panel_data(500,5)
data %<>% pdata.frame(index = c("ID", "t"))
sumtable(data, vars = c("y", "w"))
# pooled OLS
model1 <- lm(y ~ w, data = data)
# fixed effects
model2 <- plm(y ~ w , data = data, model="within")
# dummy variable regression
model3 <- lm(y ~ w + factor(ID), data = data)
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
modelsummary(model1, model2, model3, model4, model5, type = "text", keep=c("w"), keep.stat = c("n"))
modelsummary(model1, model2, model3, model4, model5)
modelsummary(list("Pooled OLs" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type",
stars = TRUE, vcov = "HC1")
modelsummary(list("Pooled OLs" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = "HC1")
modelsummary(list("Pooled OLs" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = vcovPC(x, cluster="ID"))
modelsummary(list("Pooled OLs" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovPC(x, cluster="country"))
modelsummary(list("Pooled OLs" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCL(x, cluster = ~ "ID"))
data <- create_panel_data(500,5)
data %<>% pdata.frame(index = c("ID", "t"))
sumtable(data, vars = c("y", "w"))
# pooled OLS
model1 <- lm(y ~ w, data = data)
# fixed effects
model2 <- plm(y ~ w , data = data, model="within")
# dummy variable regression
model3 <- lm(y ~ w + factor(ID), data = data)
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCL(x, cluster = ~ "ID"))
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCL(x, cluster = ~ ID))
modelsummary(list("Pooled OLS" = model1),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCL(x, cluster = ~ ID))
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCL(x, cluster = ~ ID))
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCL(x, cluster = ~ "ID"))
modelsummary(list("Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCL(x, cluster = ~ "ID"))
install.packages("clubSandwich")
library(clubSandwich)
modelsummary(list("Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCR(x, cluster = ~ "ID"))
modelsummary(list("Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCR(x, cluster = ~ ID))
modelsummary(list("Fixed Effects" = model1),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCR(x, cluster = ~ ID))
modelsummary(list("Fixed Effects" = model1),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCL(x, cluster = ~ ID))
modelsummary(list("Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCR.plm(x, cluster = ~ ID))
modelsummary(list("Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE, vcov = function(x) vcovCR.plm(x, cluster = ID))
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|se_type", coef_omit = "ID",
stars = TRUE)
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2, "DVR" = model3, "First Diff" = model4, "Random Effects" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic", coef_omit = "ID",
stars = TRUE)
vcovcr(model2, cluster = ID)
vcovCR(model2, cluster = ID)
View(data)
model2
View(model2)
# fixed effects
model2 <- plm(y ~ w , data = data, model="within")
View(model2)
vcovCR(model2, cluster = "ID")
vcovCR(model2, type = "HC1", cluster = "ID")
vcovCR(model2, type = "CR1", cluster = "ID")
vcovCL(model2, type = "HC1", cluster = "ID")
lm(y ~ w, data = data)
summary(lm(y ~ w, data = data))
summary(feols(y ~ w, data = data))
summary(feols(y ~ w, data = data, cluster = "ID"))
model1 <- lm(y ~ w, data = data)
model2 <- feols(y ~ w, data = data)
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic", coef_omit = "ID",
stars = TRUE)
model1 <- lm(y ~ w, data = data)
model2 <- feols(y ~ w, data = data, cluster = "ID")
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic", coef_omit = "ID",
stars = TRUE)
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F", coef_omit = "ID",
stars = TRUE)
model2 <- feols(y ~ w | ID, data = data, cluster = "ID")
model3 < - felm(y ~w | ID|0|ID, data= data)
library(lfe)
model3 < - felm(y ~w | ID|0|ID, data= data)
model3 < - felm(y ~w | ID | 0 | ID, data= data)
model3 <- felm(y ~w | ID | 0 | ID, data= data)
modelsummary(list("Pooled OLS" = model1, "Fixed Effects" = model2, "FE2" = model3),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F", coef_omit = "ID",
stars = TRUE)
model3 < - felm(d.y ~ d.w data= data)
model4 < - felm(d.y ~ d.w, data= data)
data %<>% pdata.frame(index = c("ID", "t"))
model4 <- plm(y ~ w , data = data, model="fd")
model4$vcov
vcovCL(model4, cluster = "ID")
vcovCL(model4, cluster = ID)
vcovCL(model4, cluster = ~ ID)
vcovCR(model4, cluster = ~ ID)
vcovCR(model4, cluster = "ID")
vcovCR(model4, cluster = "ID", type = "CR0")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR0")
model4$vcov
# pooled OLS
model1 <- feols(y ~ w, data = data, cluster = "ID")
# fixed effects
model2 <- feols(y ~ w | ID, data = data, cluster = "ID")
# dummy variable regression
model3 <- feols(y ~ w + factor(ID), data = data, cluster = "ID")
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
modelsummary(list("Pooled OLS" = model1, "FE" = model2, "DVR" = model3, "FD" = model4, "RE" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F", coef_omit = "ID",
stars = TRUE)
data <- create_panel_data(500,5)
data %<>% pdata.frame(index = c("ID", "t"))
sumtable(data, vars = c("y", "w"))
# pooled OLS
model1 <- feols(y ~ w, data = data, cluster = "ID")
# fixed effects
model2 <- feols(y ~ w | ID, data = data, cluster = "ID")
# dummy variable regression
model3 <- feols(y ~ w + factor(ID), data = data, cluster = "ID")
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
modelsummary(list("Pooled OLS" = model1, "FE" = model2, "DVR" = model3, "FD" = model4, "RE" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F", coef_omit = "ID",
stars = TRUE)
modelsummary(list("Pooled OLS" = model1, "FE" = model2, "DVR" = model3, "FD" = model4, "RE" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F|setype", coef_omit = "ID",
stars = TRUE)
create_panel_data2 <- function(N,T) {
panel_data <- crossing(ID = 1:N, t = 1:T) %>%
mutate(eta = rnorm(n(), mean=0, sd=10))
indiv_data <- data.frame(ID = 1:N,
a = rnorm(N,0,10))
panel_data %<>%
full_join(indiv_data, by = 'ID') %>%
mutate(y0 = 2 + a + eta,
y1 = y0 + 4,
w = ifelse(a > 15 & t >= 3, 1, 0),
y = y0 + (y1 - y0)*w)
return(panel_data)
}
data <- create_panel_data2(500,5)
data %<>% pdata.frame(index = c("ID", "t"))
# pooled OLS
model1 <- feols(y ~ w, data = data, cluster = "ID")
# fixed effects
model2 <- feols(y ~ w | ID, data = data, cluster = "ID")
# dummy variable regression
model3 <- feols(y ~ w + factor(ID), data = data, cluster = "ID")
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
modelsummary(list("Pooled OLS" = model1, "FE" = model2, "DVR" = model3, "FD" = model4, "RE" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F|se_type", coef_omit = "ID",
stars = TRUE)
create_panel_data2 <- function(N,T) {
panel_data <- crossing(ID = 1:N, t = 1:T) %>%
mutate(eta = rnorm(n(), mean=0, sd=10))
indiv_data <- data.frame(ID = 1:N,
a = rnorm(N,0,10))
panel_data %<>%
full_join(indiv_data, by = 'ID') %>%
mutate(y0 = 2 + a + eta,
y1 = y0 + 4,
w = ifelse(a > 15 & t >= 3, 1, 0),
y = y0 + (y1 - y0)*w)
return(panel_data)
}
data <- create_panel_data2(500,5)
data %<>% pdata.frame(index = c("ID", "t"))
# pooled OLS
model1 <- feols(y ~ w, data = data, cluster = "ID")
# fixed effects
model2 <- feols(y ~ w | ID, data = data, cluster = "ID")
# dummy variable regression
model3 <- feols(y ~ w + factor(ID), data = data, cluster = "ID")
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
modelsummary(list("Pooled OLS" = model1, "FE" = model2, "DVR" = model3, "FD" = model4, "RE" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F|se_type", coef_omit = "ID",
stars = TRUE)
create_panel_data2 <- function(N,T) {
panel_data <- crossing(ID = 1:N, t = 1:T) %>%
mutate(eta = rnorm(n(), mean=0, sd=10))
indiv_data <- data.frame(ID = 1:N,
a = rnorm(N,0,10))
panel_data %<>%
full_join(indiv_data, by = 'ID') %>%
mutate(y0 = 2 + a + eta,
y1 = y0 + 4,
w = ifelse(a > 15 & t >= 3, 1, 0),
y = y0 + (y1 - y0)*w)
return(panel_data)
}
data <- create_panel_data2(500,5)
data %<>% pdata.frame(index = c("ID", "t"))
# pooled OLS
model1 <- feols(y ~ w, data = data, cluster = "ID")
# fixed effects
model2 <- feols(y ~ w | ID, data = data, cluster = "ID")
# dummy variable regression
model3 <- feols(y ~ w + factor(ID), data = data, cluster = "ID")
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
modelsummary(list("Pooled OLS" = model1, "FE" = model2, "DVR" = model3, "FD" = model4, "RE" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F|se_type", coef_omit = "ID",
stars = TRUE)
create_panel_data2 <- function(N,T) {
panel_data <- crossing(ID = 1:N, t = 1:T) %>%
mutate(eta = rnorm(n(), mean=0, sd=10))
indiv_data <- data.frame(ID = 1:N,
a = rnorm(N,0,10))
panel_data %<>%
full_join(indiv_data, by = 'ID') %>%
mutate(y0 = 2 + a + eta,
y1 = y0 + 4,
w = ifelse(a > 15 & t >= 3, 1, 0),
y = y0 + (y1 - y0)*w)
return(panel_data)
}
data <- create_panel_data2(500,5)
data %<>% pdata.frame(index = c("ID", "t"))
# pooled OLS
model1 <- feols(y ~ w, data = data, cluster = "ID")
# fixed effects
model2 <- feols(y ~ w | ID, data = data, cluster = "ID")
# dummy variable regression
model3 <- feols(y ~ w + factor(ID), data = data, cluster = "ID")
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
modelsummary(list("Pooled OLS" = model1, "FE" = model2, "DVR" = model3, "FD" = model4, "RE" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F|se_type", coef_omit = "ID",
stars = TRUE)
create_panel_data2 <- function(N,T) {
panel_data <- crossing(ID = 1:N, t = 1:T) %>%
mutate(eta = rnorm(n(), mean=0, sd=10))
indiv_data <- data.frame(ID = 1:N,
a = rnorm(N,0,10))
panel_data %<>%
full_join(indiv_data, by = 'ID') %>%
mutate(y0 = 2 + a + eta,
y1 = y0 + 4,
w = ifelse(a > 15 & t >= 3, 1, 0),
y = y0 + (y1 - y0)*w)
return(panel_data)
}
data <- create_panel_data2(500,5)
data %<>% pdata.frame(index = c("ID", "t"))
# pooled OLS
model1 <- feols(y ~ w, data = data, cluster = "ID")
# fixed effects
model2 <- feols(y ~ w | ID, data = data, cluster = "ID")
# dummy variable regression
model3 <- feols(y ~ w + factor(ID), data = data, cluster = "ID")
# first differencing
model4 <- plm(y ~ w , data = data, model="fd")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
# random effects
model5 <- plm(y ~ w , data = data, model="random")
model4$vcov <- vcovCR(model4, cluster = "ID", type = "CR1S")
modelsummary(list("Pooled OLS" = model1, "FE" = model2, "DVR" = model3, "FD" = model4, "RE" = model5),
gof_omit = "IC|Log|Adj|p\\.value|statistic|F|se_type", coef_omit = "ID",
stars = TRUE)
install.packages("lme4")
