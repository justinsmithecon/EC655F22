theme_dag()
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges(aes(edge_linetype = linetype)) +
geom_dag_text() +
theme_dag()
View(coord_dag)
View(dag)
View(dag[["data"]])
dag <- dagify(y~w+x+u, u~x, w~x, coords = coord_dag) %>%
tidy_dagitty() %>% mutate(linetype = ifelse(name == "u" | to = "u", "dashed", "solid"))
dag <- dagify(y~w+x+u, u~x, w~x, coords = coord_dag) %>%
tidy_dagitty() %>% mutate(linetype = ifelse(name == "u" | to == "u", "dashed", "solid"))
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges(aes(edge_linetype = linetype)) +
geom_dag_text() +
theme_dag()
library(tidyverse)
library(vtable)
library(ggthemes)
library(ggdag)
data <- data.frame(eta=rnorm(100000,0,1)) %>%
mutate(y0 = 2 + eta, y1 = y0 + 5,
treat_eff = y1 - y0)
data %<>% mutate(w = if_else(runif(100000) > .5,1,0),
y = y0 + (y1-y0)*w) %>%
group_by(w)
data
sum<-summarize(data, mean(y))
sum
sum<-summarize(data, my=mean(y))
sum
filter(sum, w == 0)
filter(sum, w == 1) - filter(sum, w ==1
)
filter(sum, w == 1) - filter(sum, w ==0)
select(sum, my) %>% filter(sum, w == 1) - filter(sum, w ==0)
select(sum, my) %>% filter(w == 1) - filter(w ==0)
filter(sum,w == 1) - filter(sum,w ==0) %>% select(my)
filter(sum,w == 1) - filter(sum,w ==0)
sum %>%filter(w == 1) - filter(w ==0) %>% select(my)
sum %>%filter(w == 1) - filter(w ==0)
sum
sum %>%filter(w == 1) - filter(w ==0)
sum %>%(filter(w == 1) - filter(w ==0) )
View(data)
View(sum)
data <- data.frame(eta=rnorm(100000,0,1)) %>%mutate(y0 = 2 + eta, y1 = y0 + 5, w = if_else(runif(100000) > .5,1,0)) %>% mutate(y = y0 + (y1-y0)*w) %>%group_by(w) %>%summarize(data, my = mean(y))
data2 <- data.frame(eta=rnorm(100000,0,1)) %>%mutate(y0 = 2 + eta, y1 = y0 + 5, w = if_else(runif(100000) > .5,1,0)) %>% mutate(y = y0 + (y1-y0)*w) %>%group_by(w) %>%summarize(data, my = mean(y))
View(data2)
data2 <- data.frame(eta=rnorm(100000,0,1)) %>%mutate(y0 = 2 + eta, y1 = y0 + 5, w = if_else(runif(100000) > .5,1,0)) %>% mutate(y = y0 + (y1-y0)*w) %>%group_by(w) %>%summarize(my = mean(y))
data2 <- data2 %>%
mutate(y0_diff = my - lag(my))
data2
summarize(data, my = mean(y)) %>% mutate(diff_y = my - lag(my))
dagdata <- data.frame(
talent = rnorm(10000),
effort = rnorm(10000),
elite = ifelse(talent + effort > 4,1,0)
)
dagdata <- tibble(
talent = rnorm(10000),
effort = rnorm(10000),
elite = ifelse(talent + effort > 4,1,0)
)
dagdata <- data.frame(
talent = rnorm(10000),
effort = rnorm(10000),
elite = ifelse(talent + effort > 4,1,0)
)
dagdata <- tibble(
talent = rnorm(10000),
effort = rnorm(10000),
elite = ifelse(talent + effort > 4,1,0)
)
View(dagdata)
lm(talent ~effort, data = dagdata)
lm(talent ~effort + elite, data = dagdata)
ggplot(dagdata, aes(x = effort, y = talent)) +
geom_point()
ggplot(dagdata, aes(x = effort, y = talent, color = elite)) +
geom_point()
dagdata <- tibble(
talent = rnorm(10000),
effort = rnorm(10000),
elite = ifelse(talent + effort > 2,1,0)
)
ggplot(dagdata, aes(x = effort, y = talent, color = elite)) +
geom_point()
dagdata <- tibble(
talent = rnorm(10000),
effort = rnorm(10000),
elite = ifelse(talent + effort > 1,1,0)
)
ggplot(dagdata, aes(x = effort, y = talent, color = elite)) +
geom_point()
lm(talent ~effort + elite, data = dagdata)
lm(effort ~talent + elite, data = dagdata)
ggplot(dagdata) +
geom_point( aes(x = effort, y = talent, color = as.factor(elite))) +
geom_smooth( aes(x = effort, y = talent, color = as.factor(elite)), method = "lm") +
geom_smooth( aes(x = effort, y = talent), method = "lm")
ggplot(dagdata, aes(x = effort, y = talent)) +
geom_point() +
geom_smooth(method = "lm")
ggplot(dagdata, aes(x = effort, y = talent)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ggplot(dagdata,aes(x = effort, y = talent, color = as.factor(elite)) ) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ggplot(dagdata,aes(x = effort, y = talent, color = as.factor(elite)) ) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_pander()
ggplot(dagdata,aes(x = effort, y = talent, color = as.factor(elite)) ) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_pander() +
ggplot(dagdata,aes(x = effort, y = talent, color = as.factor(elite)) ) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_pander() + scale_brewer_discrete()
ggplot(dagdata,aes(x = effort, y = talent, color = as.factor(elite)) ) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_pander() + scale_color_brewer()
ggplot(dagdata,aes(x = effort, y = talent, color = as.factor(elite)) ) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_pander() + scale_color_wsj()
ggplot(dagdata,aes(x = effort, y = talent, color = as.factor(elite)) ) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_pander() + scale_color_grey()
ggplot(dagdata,aes(x = effort, y = talent, color = as.factor(elite)) ) +
geom_point(alpha = 0.2) +
geom_smooth(method = "lm", se = FALSE) +
theme_pander() +
scale_color_grey()
lm(talent ~ effort, data = dagdata)
lm(talent ~ effort + elite, data = dagdata)
dagdata <- tibble(
ability = rnorm(10000),
educ = ifelse(ability + rnorm(10000, mean = 0, sd = 0.5) > 1,1,0),
u = ifelse(ability + rnorm(10000, mean = 0, sd = 0.25) > 1.5,1,0),
inc = educ + ability + u
)
View(dagdata)
lm(inc ~educ, data = dagdata)
lm(inc ~educ + ability, data = dagdata)
lm(inc ~educ + ability + u, data = dagdata)
dagdata <- tibble(
ability = rnorm(100000),
educ = ifelse(ability + rnorm(100000, mean = 0, sd = 0.5) > 1,1,0),
u = ifelse(ability + rnorm(100000, mean = 0, sd = 0.25) > 1.5,1,0),
inc = educ + ability + u
)
lm(inc ~educ + ability + u, data = dagdata)
lm(inc ~educ + ability , data = dagdata)
dagdata <- tibble(
ability = rnorm(1000000),
educ = ifelse(ability + rnorm(1000000, mean = 0, sd = 0.5) > 1,1,0),
u = ifelse(ability + rnorm(1000000, mean = 0, sd = 0.25) > 1.5,1,0),
inc = educ + ability + u
)
lm(inc ~educ + ability , data = dagdata)
lm(inc ~educ , data = dagdata)
dagdata <- tibble(
ability = rnorm(10000),
educ = ifelse(ability + rnorm(10000, mean = 0, sd = 0.5) > 1,1,0),
u = ability + rnorm(10000, mean = 0, sd = 2),
inc = educ + ability + u
)
lm(inc ~educ , data = dagdata)
lm(inc ~educ + ability , data = dagdata)
dagdata <- tibble(
ability = rnorm(1000000),
educ = ifelse(ability + rnorm(1000000, mean = 0, sd = 0.5) > 1,1,0),
u = ability + rnorm(1000000, mean = 0, sd = 2),
inc = educ + ability + u
)
lm(inc ~educ + ability , data = dagdata)
install.packages("wooldridge")
test <- wooldridge::data(econmath)
test <- wooldridge::data("econmath")
test <- data("econmath")
library(wooldridge)
test <- data("econmath")
force(econmath)
View(econmath)
View(econmath)
write_csv(/Users/jsmith/Library/CloudStorage/OneDrive-WilfridLaurierUniversity/Teaching/EC655/Fall-2023/ec655f23/assignments/files/econmath.csv)
write_csv("assignments/files/econmath.csv")
library(tidyverse)
write_csv("assignments/files/econmath.csv")
write_csv(econmath, "assignments/files/econmath.csv")
View(econmath)
econmath %>% select(score, hsgpa, study, age) %>% gtsummary::tbl_summary()
econmath %>% select(score, hsgpa, study, age) %>% gtsummary::tbl_summary(statistic = all_continuous() ~ c("{median} ({p25}, {p75})", "{min}, {max}"))
library(gtsummary)
econmath %>%
select(score, hsgpa, study, age) %>%
tbl_summary()
econmath %>%
select(score, hsgpa, study, age) %>%
tbl_summary(
statistic = list(all_continuous() ~ "{mean} ({sd})")
)
econmath %>%
select(score, hsgpa, study, age) %>%
tbl_summary(
statistic = list(all_continuous() ~ "{mean}, {sd}, {min}, {max}")
)
library(vtable)
econmath %>%
select(score, hsgpa, study, age) %>%
sumtable()
setwd("~/Library/CloudStorage/OneDrive-WilfridLaurierUniversity/Teaching/EC655/Fall-2023/ec655f23/assignments/files")
econmath %>%
select(score, hsgpa, study, age) %>%
sumtable(summ = c(mean(x), sd(x), min(x), max(x)))
install.packages("ggExtra")
p<-ggplot(econmath, aes(x = hsgpa, y = age)) +
geom_violin() +
labs(title = "Density of Economics Scores",
x = "High School GPA", y = "Density")
p
ggplot(mtcars, aes(mpg, factor(cyl))) +
geom_violin()
p<-ggplot(econmath, aes(x = hsgpa, y = as.factor(age))) +
geom_violin() +
labs(title = "Density of Economics Scores",
x = "High School GPA", y = "Density")
p
p<-ggplot(econmath, aes(x = hsgpa, y = as.factor(age))) +
geom_violin() +
labs(title = "Density of Economics Scores",
x = "High School GPA", y = "Density")
p
p<-ggplot(econmath, aes(x = hsgpa, y = as.factor(econhs))) +
geom_violin() +
labs(title = "Density of Economics Scores",
x = "High School GPA", y = "Density")
p
p<-ggplot(econmath, aes(y = hsgpa, x = as.factor(econhs))) +
geom_violin() +
labs(title = "Density of Economics Scores",
x = "High School GPA", y = "Density")
p
p<-ggplot(econmath, aes(y = hsgpa, x = econhs)) +
geom_violin() +
labs(title = "Density of Economics Scores",
x = "High School GPA", y = "Density")
p
p<-ggplot(econmath, aes(y = hsgpa, x = as.factor(econhs))) +
geom_violin() +
labs(title = "Density of Economics Scores",
x = "High School GPA", y = "Density")
p
p<-ggplot(econmath, aes(y = hsgpa, x = as.factor(age))) +
geom_violin() +
labs(title = "Density of Economics Scores",
x = "High School GPA", y = "Density")
p
p<-ggplot(econmath, aes(y = score, x = hsgpa)) +
geom_point() +
geom_smooth(method = "lm")
labs(title = "Economics Grades and High School GPA",
x = "High School GPA", y = "Economics Score")
p
p<-ggplot(econmath, aes(y = score, x = hsgpa)) +
geom_point() +
geom_smooth(method = "loess")
labs(title = "Economics Grades and High School GPA",
x = "High School GPA", y = "Economics Score")
p<-ggplot(econmath, aes(y = score, x = hsgpa)) +
geom_point() +
geom_smooth(method = "loess")
labs(title = "Economics Grades and High School GPA",
x = "High School GPA", y = "Economics Score")
p<-ggplot(econmath, aes(y = score, x = hsgpa)) +
geom_point() +
geom_smooth(method = "loess") +
labs(title = "Economics Grades and High School GPA",
x = "High School GPA", y = "Economics Score")
p<-ggplot(econmath, aes(y = score, x = hsgpa)) +
geom_point() +
geom_smooth(method = "loess") +
labs(title = "Economics Grades and High School GPA",
x = "High School GPA", y = "Economics Score")
p<-ggplot(econmath, aes(y = score, x = hsgpa)) +
geom_point() +
geom_smooth(method = "loess") +
labs(title = "Economics Grades and High School GPA",
x = "High School GPA", y = "Economics Score")
p
data <- tibble(x = runif(1000, min = 0, max = 1))
View(data)
data <- tibble(x = runif(1000, min = 0, max = 25))
View(data)
data <- tibble(x = runif(1000, min = 0, max = 25),
y = 1 + x + 0.5x^2 + rnorm(0,1))
data <- tibble(x = runif(1000, min = 0, max = 25),
y = 1 + x + 0.5x^2 + rnorm(1000,0,1))
data <- tibble(x = runif(1000, min = 0, max = 25),
y = 1 + x + 0.5*x^2 + rnorm(1000,0,1))
View(data)
ggplot(data, x = x, y = y) + geom_point()
ggplot(data, aes(x = x, y = y)) + geom_point()
data <- tibble(x = runif(1000, min = 0, max = 25),
y = 1 + x + 0.5*x^2 + rnorm(1000,0,10))
ggplot(data, aes(x = x, y = y)) + geom_point()
data <- tibble(x = runif(1000, min = 0, max = 25),
y = 1 + x + 0.5*x^2 + rnorm(1000,0,40))
ggplot(data, aes(x = x, y = y)) + geom_point()
ggplot(data, aes(x = x, y = y)) + geom_point() + geom_smooth(method = "lm")
data <- tibble(x = runif(1000, min = 0, max = 25),
y = 1 + x + 0.5*x^2 + rnorm(1000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm") +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
data <- tibble(x = runif(1000, min = 0, max = 25),
y = 1 + x + 0.5*x^2 + rnorm(1000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm") +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
data <- tibble(x = rnorm(1000, mean = 0, sd = 10),
y = 1 + x + 0.5*x^2 + rnorm(1000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
data <- tibble(x = rnorm(1000, mean = 20, sd = 10),
y = 1 + x + 0.5*x^2 + rnorm(1000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
data <- tibble(x = runif(100000, min = 0, max = 20),
y = 1 + x + 0.5*x^2 + rnorm(100000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
lm(y ~ x, data = data)
data %<>% mutate(x2 = x^2)
library(magrittr)
data %<>% mutate(x2 = x^2)
cov(data$x, data$x2)
var(data$x)
670.8064/33.48737
cov(data$y, data$x2)
cov(data$y, data$x)
cov(data$y, data$x)/var(data$x)
data <- tibble(x = rnorm(100000, mean = 20, sd = 5),
y = 1 + x + 0.5*x^2 + rnorm(100000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
data <- tibble(x = rnorm(1000, mean = 30, sd = 5),
y = 1 + x + 0.5*x^2 + rnorm(1000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
lm(y ~ x, data = data)
cov(data$x, data$x2)
data %<>% mutate(x2 = x^2)
cov(data$x, data$x2)
corr(data$x, data$x2)
cor(data$x, data$x2)
30^3 + 3*30*25 - 30*(30^2 + 25)
mean(data$x2)
data <- tibble(x = rnorm(10000,0,5),
y = 1 + x + 0.5*x^2 + rnorm(10000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
data <- tibble(x = rnorm(10000,30,5),
y = 1 + x + 0.5*x^2 + rnorm(10000,0,40))
ggplot(data, aes(x = x, y = y)) +
geom_point() +
geom_function(fun = function(x) 1 + x + 0.5*x^2)
data %<>% mutate(x2 = x^2)
mean(data$x2)
1 + 30 + 925/2
data <- tibble(x = rnorm(100000,30,5),
y = 1 + x + 0.5*x^2 + rnorm(100000,0,40))
lm(y ~ x, data = data)
493.5-900
data <- tibble(x = rnorm(100000,30,5),
y = 1 + x + 0.5*x^2 + rnorm(100000,0,40))
25 + 0.5*(30^3 + 3*30*25-30*(30^2+25))
775/25
1 + 30 + 0.5*(25 + 30^2)
493.5 - 31*30
ggplot() +
geom_function(fun = function(x) 1 + x + 0.5*x^2) +
geom_function(fun = function(x) 436.5 + 31*x )
ggplot() +
geom_function(fun = function(x) 1 + x + 0.5*x^2) +
geom_function(fun = function(x) -436.5 + 31*x )
ggplot() +
geom_function(fun = function(x) 1 + x + 0.5*x^2) +
geom_function(fun = function(x) -436.5 + 31*x ) +
xlim(0,50)
library(vtable)
setwd("~/Library/CloudStorage/OneDrive-WilfridLaurierUniversity/Teaching/EC655/Fall-2023/ec655f23/slides/ols")
setwd("~/Library/CloudStorage/OneDrive-WilfridLaurierUniversity/Teaching/EC655/Fall-2023")
setwd("~/Library/CloudStorage/OneDrive-WilfridLaurierUniversity/Teaching/EC655/Fall-2023/ec655f23/assignments/files")
potential <- read_csv("a2potential.csv")
library(tidyverse)
potential <- read_csv("a2potential.csv")
View(potential)
View(potential)
potential <- read_csv("a2potential.csv")
View(potential)
ggplot(potential, aes(x = y1)) + geom_density()
ggplot(potential) + geom_density(aes(x = y1)) + geom_density(aes(x = y0))
library(magrittr)
potential %<>% mutate(treateff = y1=y0)
potential %<>% mutate(treateff = y1-y0)
View(potential)
summary(potential)
potential <- tibble(
y0 = 6 + rnorm(0,3)
)
ggplot(potential, aes(x = y0)) + geom_density()
potential <- tibble(y0 = 6 + rnorm(0,3))
potential <- data.frame(y0 = 6 + rnorm(0,3))
potential <- tibble(
y0 = 6 + rnorm(1000,0,3)
)
ggplot(potential, aes(x = y0)) + geom_density()
potential <- tibble(
y0 = 6 + rnorm(1000,0,3),
y1 = 8 + rnorm(1000,0,3)
)
ggplot(potential) + geom_density(aes(x = y1)) + geom_density(aes(x = y0))
potential %<>% mutate(treateff = y1-y0)
ggplot(potential) + geom_density(aes(x = treateff))
potential <- tibble(
y0 = 6 + rnorm(1000,0,3),
y1 = 8 + rnorm(1000,0,1)
)
potential %<>% mutate(treateff = y1-y0)
ggplot(potential) + geom_density(aes(x = treateff))
coord_dag<-list(x = c(x = 1, w = 0, y = 2, u=2), y = c(x = 0, w = 1, y = 1, u=0))
dag <- dagify(y~w+x+u, u~x, w~x, coords = coord_dag) %>%
tidy_dagitty() %>% mutate(linetype = ifelse(name == "u" | to == "u", "dashed", "solid"))
library(ggthemes)
library(ggdag)
coord_dag<-list(x = c(x = 1, w = 0, y = 2, u=2), y = c(x = 0, w = 1, y = 1, u=0))
dag <- dagify(y~w+x+u, u~x, w~x, coords = coord_dag) %>%
tidy_dagitty() %>% mutate(linetype = ifelse(name == "u" | to == "u", "dashed", "solid"))
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges(aes(edge_linetype = linetype)) +
geom_dag_text() +
theme_dag()
coord_dag<-list(x = c(A = 0, S = 0, Y = 1, P = 1, F = 1.5), y = c(A = 0, S = 1, Y = 0, P = 1, F = 1))
dag <- dagify(y~P + A + F, P ~ F + S, A~ P + S, coords = coord_dag) %>%
tidy_dagitty() %>% mutate(linetype = ifelse(name == "u" | to == "u", "dashed", "solid"))
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges(aes(edge_linetype = linetype)) +
geom_dag_text() +
theme_dag()
coord_dag<-list(x = c(A = 0, S = 0, Y = 1, P = 1, F = 1.5), y = c(A = 0, S = 1, Y = 0, P = 1, F = 1))
dag <- dagify(Y~P + A + F, P ~ F + S, A~ P + S, coords = coord_dag) %>%
tidy_dagitty() %>% mutate(linetype = ifelse(name == "u" | to == "u", "dashed", "solid"))
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges(aes(edge_linetype = linetype)) +
geom_dag_text() +
theme_dag()
coord_dag<-list(x = c(A = 0, S = 0, Y = 1, P = 1, F = 1.5), y = c(A = 0, S = 1, Y = 0, P = 1, F = 1))
dag <- dagify(Y~P + A + F, P ~ F + S, A~ P + S, coords = coord_dag) %>%
tidy_dagitty() %>% mutate(linetype = ifelse(name == "F" | to == "Y" | name == "F" | to == "P" , "dashed", "solid"))
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges(aes(edge_linetype = linetype)) +
geom_dag_text() +
theme_dag()
coord_dag<-list(x = c(A = 0, S = 0, Y = 1, P = 1, F = 1.5), y = c(A = 0, S = 1, Y = 0, P = 1, F = 1))
dag <- dagify(Y~P + A + F, P ~ F + S, A~ P + S, coords = coord_dag) %>%
tidy_dagitty() %>% mutate(linetype = ifelse(name == "F" & to == "Y" | name == "F" & to == "P" , "dashed", "solid"))
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges(aes(edge_linetype = linetype)) +
geom_dag_text() +
theme_dag()
?sleep75
library(wooldridge)
?sleep75
data <- sleep75
coord_dag<-list(x = c(A = 0, S = 0, Y = 1, P = 1, F = 1.5), y = c(A = 0, S = 1, Y = 0, P = 1, F = 1))
dag <- dagify(Y~P + A + F, P ~ F + S, A~ P + S, coords = coord_dag) %>%
tidy_dagitty()
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges(aes(edge_linetype = linetype)) +
geom_dag_text() +
theme_dag()
coord_dag<-list(x = c(A = 0, S = 0, Y = 1, P = 1, F = 1.5), y = c(A = 0, S = 1, Y = 0, P = 1, F = 1))
dag <- dagify(Y~P + A + F, P ~ F + S, A~ P + S, coords = coord_dag) %>%
tidy_dagitty()
ggplot(dag,aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_point() +
geom_dag_edges() +
geom_dag_text() +
theme_dag()
